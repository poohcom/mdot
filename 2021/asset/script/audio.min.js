/*!
 * audioPlayer v1.0.4 ~ Copyright (c) 2018 Xzavier, https://github.com/xiaohuazheng/audioplayer
 * Released under MIT license
 */
!function(t,a,e,i){if(!t("#ppq-audio-player-style").length){t("body").prepend('')}var r="ontouchstart"in a,n=r?"touchstart":"mousedown",p=r?"touchmove":"mousemove",o=r?"touchcancel":"mouseup",l=["webkit","moz","ms","o"],d=y();function s(t){var a=Math.floor(t/60),e=Math.floor(t-60*a);return(a<10?"0"+a:a)+":"+(e<10?"0"+e:e)}function u(t){if(!t)return!1;var a=e.createElement("audio");if("function"!=typeof a.canPlayType)return!1;var i=a.canPlayType("audio/"+t.split(".").pop().toLowerCase());return"probably"===i||"maybe"===i}function y(){if("hidden"in e)return"hidden";for(var t=0;t<l.length;t++)if(l[t]+"Hidden"in e)return l[t]+"Hidden";return null}t.fn.initAudioPlayer=function(){return this.each(function(){if("audio"===t(this).prop("tagName").toLowerCase()){var i=t(this),c=i.attr("src"),f=!1;if(u(c)?f=!0:i.find("source").each(function(){if(u(t(this).attr("src")))return f=!0,!1}),f){var h=t('<div class="ppq-audio-player">'+t("<div>").append(i.eq(0).clone()).html()+'<div class="play-pause-btn"><a href="javascript: void(0);" class="play-pause-icon"></a></div></div>'),b=h.find("audio")[0];h.find("audio").addClass("audio-hidden"),h.append('<div class="player-time player-time-current"></div>\t\t\t\t<div class="player-time player-time-duration"></div>\t\t\t\t<div class="player-bar">\t\t\t\t\t<div class="player-bar-loaded"></div>\t\t\t\t\t<div class="player-bar-played"></div>\t\t\t\t</div>');var v=h.find(".player-bar"),g=h.find(".player-bar-played"),A=h.find(".player-bar-loaded"),m=h.find(".player-time-current"),q=h.find(".player-time-duration");if(m.html("00:00"),q.html("&hellip;"),b.addEventListener("loadeddata",function(){var a=setInterval(function(){if(b.buffered.length<1)return!0;A.width(b.buffered.end(0)/b.duration*100+"%"),Math.floor(b.buffered.end(0))>=Math.floor(b.duration)&&clearInterval(a)},100);q.html(t.isNumeric(b.duration)?s(b.duration):"&hellip;")}),b.addEventListener("timeupdate",function(){m.html(s(b.currentTime)),g.width(b.currentTime/b.duration*100+"%")}),b.addEventListener("ended",function(){h.removeClass("player-playing").addClass("player-paused")}),v.on(n,function(t){b.currentTime=w(t),v.on(p,function(t){b.currentTime=w(t)})}).on(o,function(){v.unbind(p)}),h.find(".play-pause-btn").on("click",function(){return h.hasClass("player-playing")?(h.removeClass("player-playing").addClass("player-paused"),b.pause()):(h.addClass("player-playing").removeClass("player-paused"),b.play()),!1}),i.replaceWith(h),d){var x=d.replace(/[H|h]idden/,"")+"visibilitychange";e.addEventListener(x,function(){((function(){var t=y();if(!t)return!1;return e[t]})()||"hidden"===function(){if("visibilityState"in e)return"visibilityState";for(var t=0;t<l.length;t++)if(l[t]+"VisibilityState"in e)return l[t]+"VisibilityState";return null}())&&(h.removeClass("player-playing").addClass("player-paused"),b.pause())},!1)}a.addEventListener("beforeunload",function(){h.removeClass("player-playing").addClass("player-paused"),b.pause()},!1)}}function w(t){var a=r?t.originalEvent.touches[0]:t;return Math.round(b.duration*(a.pageX-v.offset().left)/v.width())}}),this}}(jQuery,window,document);
